<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lane Clash ‚Äî Prototype</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="site-header">
    <h1>Lane Clash</h1>
    <p class="tagline">A tiny lane-strategy prototype</p>
  </header>

  <!-- Main Menu -->
  <section id="screenMenu" class="screen">
    <div class="hero-card">
      <div class="hero-content">
        <div class="hero-icon">‚öîÔ∏è</div>
        <h2 class="hero-title">Welcome to Lane Clash</h2>
        <p class="hero-subtitle">Lane-ear algebra!</p>
      </div>

      <div class="menu-grid">
        <button id="btnPlay" class="menu-btn menu-btn-primary">
          <span class="menu-btn-icon">üéÆ</span>
          <span class="menu-btn-text">
            <strong>Play Game</strong>
            <small>Battle against AI</small>
          </span>
        </button>
        <button id="btnEncyclopedia" class="menu-btn">
          <span class="menu-btn-icon">üìö</span>
          <span class="menu-btn-text">
            <strong>Encyclopedia</strong>
            <small>View cards & deck</small>
          </span>
        </button>
        <button id="btnUpdateLog" class="menu-btn">
          <span class="menu-btn-icon">üìã</span>
          <span class="menu-btn-text">
            <strong>Update Log</strong>
            <small>See what's new</small>
          </span>
        </button>
      </div>

      <div class="hint-box">
        <span class="hint-icon">üí°</span>
        <span>Blue (you) at the bottom. Red (AI) at the top.</span>
      </div>
    </div>
  </section>

  <!-- Play Screen -->
  <section id="screenPlay" class="screen" style="display:none">
    <div class="toolbar">
      <div class="title">Play ‚Äî Blue (You) vs Red (AI)</div>
      <button id="btnBackFromPlay" class="btn small">Back</button>
    </div>

    <canvas id="game" class="game"></canvas>

    <div class="hand">
      <div id="hand0" class="hand-slot"></div>
      <div id="hand1" class="hand-slot"></div>
    </div>

    <p class="ins">
      Click a card (or press <kbd>1</kbd>/<kbd>2</kbd>), then click your half to deploy.
      Valid tiles highlight in green. Elixir: +1 / 2s.
    </p>

    <!-- End Game Overlay -->
    <div id="endGameOverlay" class="end-game-overlay" style="display:none">
      <div class="end-game-card">
        <h2 id="endGameTitle">Victory!</h2>
        <div id="endGameStats" class="end-game-stats">
          <div class="stat-item">
            <span class="stat-label">Coins Earned</span>
            <span class="stat-value" id="coinsEarned">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Damage Dealt</span>
            <span class="stat-value" id="damageDealt">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Towers Destroyed</span>
            <span class="stat-value" id="towersDestroyed">0</span>
          </div>
        </div>
        <div class="end-game-buttons">
          <button id="btnPlayAgain" class="btn primary">Play Again</button>
          <button id="btnBackToMenu" class="btn">Back to Menu</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Encyclopedia -->
  <section id="screenEncyclopedia" class="screen" style="display:none">
    <div class="toolbar">
      <div class="title">Encyclopedia</div>
      <button id="btnBackFromEnc" class="btn small">Back</button>
    </div>

    <!-- Encyclopedia Tabs -->
    <div class="ency-tabs">
      <button id="tabCards" class="ency-tab active">Cards</button>
      <button id="tabDeck" class="ency-tab">Deck</button>
      <button id="tabProgression" class="ency-tab">Progression</button>
    </div>

    <!-- Cards Tab Content -->
    <div id="tabContentCards" class="ency tab-content" style="display:block">
      <article class="entry entry-tower">
        <div class="tower-icon">üëë</div>
        <div>
          <h3>King Tower</h3>
          <ul class="stats">
            <li>HP: 2000</li>
            <li>DMG: 50 / 1.5s</li>
            <li>Range: 260</li>
          </ul>
          <p>The heart of your defense. If destroyed, you lose the match.</p>
        </div>
      </article>

      <article class="entry entry-tower">
        <div class="tower-icon">üèπ</div>
        <div>
          <h3>Crossbow Tower</h3>
          <ul class="stats">
            <li>HP: 1000</li>
            <li>DMG: 30 / 1.0s</li>
            <li>Range: 300</li>
          </ul>
          <p>Defensive structure protecting lanes. Destroyed towers count toward victory.</p>
        </div>
      </article>

      <article class="entry">
        <img src="./assets/Knight.png" alt="Knight card" />
        <div>
          <h3>Knight <span class="rar rar-common">COMMON</span></h3>
          <ul class="stats">
            <li>Elixir Cost: 2</li>
            <li>HP: 200</li>
            <li>DMG: 25 / 1.0s</li>
            <li>Speed: 30 px/s</li>
            <li>Unit Count: 1</li>
          </ul>
          <p>A brave melee fighter with steady stats and reliable defense.</p>
        </div>
      </article>

      <article class="entry">
        <img src="./assets/Archers.png" alt="Archers card" />
        <div>
          <h3>Archers <span class="rar rar-common">COMMON</span></h3>
          <ul class="stats">
            <li>Elixir Cost: 2</li>
            <li>HP: 60</li>
            <li>DMG: 10 / 0.75s</li>
            <li>Range: 120</li>
            <li>Speed: 35 px/s</li>
            <li>Unit Count: 2</li>
          </ul>
          <p>Paired ranged attackers with precise volleys from a safe distance.</p>
        </div>
      </article>

      <article class="entry">
        <img src="./assets/Mini-MEGA.png" alt="Mini-MEGA card" />
        <div>
          <h3>Mini-MEGA <span class="rar rar-common">COMMON</span></h3>
          <ul class="stats">
            <li>Elixir Cost: 3</li>
            <li>HP: 250</li>
            <li>DMG: 100 / 1.5s</li>
            <li>Speed: 20 px/s</li>
            <li>Unit Count: 1</li>
          </ul>
          <p>A compact bot that trades speed for crushing punches.</p>
        </div>
      </article>

      <article class="entry">
        <img src="./assets/MEGA.png" alt="MEGA card" />
        <div>
          <h3>MEGA <span class="rar rar-rare">RARE</span></h3>
          <ul class="stats">
            <li>Elixir Cost: 5</li>
            <li>HP: 800</li>
            <li>DMG: 150 / 2.0s</li>
            <li>Speed: 15 px/s</li>
            <li>Unit Count: 1</li>
          </ul>
          <p>A massive war machine with devastating power. Slow but nearly unstoppable.</p>
        </div>
      </article>

      <article class="entry">
        <img src="./assets/Skeleton-Army.png" alt="Skeleton Army card" />
        <div>
          <h3>Skeleton Army <span class="rar rar-rare">RARE</span></h3>
          <ul class="stats">
            <li>Elixir Cost: 4</li>
            <li>HP: 20 (per skeleton)</li>
            <li>DMG: 25 / 1.0s (vs MEGA), 5 / 1.0s (vs others)</li>
            <li>Speed: 30 px/s</li>
            <li>Unit Count: 8</li>
          </ul>
          <p>A horde of skeletal warriors. Weak individually but overwhelms with numbers. Deals bonus damage to MEGA units.</p>
        </div>
      </article>
    </div>

    <!-- Deck Tab Content -->
    <div id="tabContentDeck" class="tab-content" style="display:none">
      <div class="card">
        <div class="coins-display">
          <div class="coins-icon">üí∞</div>
          <div class="coins-info">
            <div class="coins-label">Your Coins</div>
            <div class="coins-value" id="deckTotalCoins">0</div>
          </div>
        </div>
      </div>

      <div class="deck-cards" id="deckCards">
        <!-- Will be populated by JavaScript -->
      </div>
    </div>

    <!-- Progression Tab Content -->
    <div id="tabContentProgression" class="tab-content" style="display:none">
      <div class="card">
        <div class="coins-display">
          <div class="coins-icon">üí∞</div>
          <div class="coins-info">
            <div class="coins-label">Total Coins</div>
            <div class="coins-value" id="totalCoins">0</div>
          </div>
        </div>
      </div>

      <div class="card">
        <h3>Card Progression System</h3>
        <p>Upgrade your cards to increase their effectiveness in battle. Each card can be upgraded from Level 0 to Level 5.</p>

        <h4>Earning Coins</h4>
        <p>Coins are earned during battle based on damage dealt:</p>
        <ul class="stats">
          <li><strong>Earn Rate:</strong> 0.1 coins per 1 damage dealt</li>
          <li><strong>Example:</strong> Dealing 100 damage = 10 coins earned</li>
        </ul>

        <h4>Level Benefits</h4>
        <p>Each level increases your card's Health and Damage per Hit:</p>
        <table class="upgrade-table">
          <thead>
            <tr>
              <th>Level</th>
              <th>Stat Increase</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>Level 1</td><td>+10% Health & Damage</td></tr>
            <tr><td>Level 2</td><td>+20% Health & Damage</td></tr>
            <tr><td>Level 3</td><td>+30% Health & Damage</td></tr>
            <tr><td>Level 4</td><td>+40% Health & Damage</td></tr>
            <tr><td>Level 5</td><td>+50% Health & Damage</td></tr>
          </tbody>
        </table>

        <h4>Upgrade Costs</h4>

        <div class="progression-tier">
          <h5>Common Cards <span class="rar rar-common">COMMON</span></h5>
          <p class="muted">Knight, Archers, Mini-MEGA (3 cards)</p>
          <table class="upgrade-table">
            <thead>
              <tr>
                <th>Level</th>
                <th>Cost</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>0 ‚Üí 1</td><td>100 Coins</td></tr>
              <tr><td>1 ‚Üí 2</td><td>250 Coins</td></tr>
              <tr><td>2 ‚Üí 3</td><td>500 Coins</td></tr>
              <tr><td>3 ‚Üí 4</td><td>1,000 Coins</td></tr>
              <tr><td>4 ‚Üí 5</td><td>2,500 Coins</td></tr>
              <tr class="total-row"><td><strong>Total</strong></td><td><strong>4,350 Coins</strong></td></tr>
            </tbody>
          </table>
        </div>

        <div class="progression-tier">
          <h5>Rare Cards <span class="rar rar-rare">RARE</span></h5>
          <p class="muted">MEGA, Skeleton Army (2 cards)</p>
          <table class="upgrade-table">
            <thead>
              <tr>
                <th>Level</th>
                <th>Cost</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>0 ‚Üí 1</td><td>200 Coins</td></tr>
              <tr><td>1 ‚Üí 2</td><td>500 Coins</td></tr>
              <tr><td>2 ‚Üí 3</td><td>1,000 Coins</td></tr>
              <tr><td>3 ‚Üí 4</td><td>2,000 Coins</td></tr>
              <tr><td>4 ‚Üí 5</td><td>5,000 Coins</td></tr>
              <tr class="total-row"><td><strong>Total</strong></td><td><strong>8,700 Coins</strong></td></tr>
            </tbody>
          </table>
        </div>

        <p class="hint" style="margin-top: 20px;">
          <strong>Note:</strong> Upgrade functionality will be implemented in a future update. This information is provided for reference.
        </p>
      </div>
    </div>
  </section>

  <!-- Update Log -->
  <section id="screenUpdateLog" class="screen" style="display:none">
    <div class="toolbar">
      <div class="title">Update Log</div>
      <button id="btnBackFromLog" class="btn small">Back</button>
    </div>

    <div class="card">
      <h3>v0.3.4 - Damage Feedback System</h3>
      <ul>
        <li><strong>Visual Feedback:</strong> Units and towers flash when taking damage (blue flash for blue team, red flash for red team)</li>
        <li><strong>Damage Display:</strong> Recent damage amount shown in health bar after each attack</li>
        <li><strong>Level Display:</strong> Card level number displayed next to health bars for leveled units</li>
        <li><strong>AI Balance:</strong> AI always uses level 0 cards regardless of player's card levels</li>
        <li><strong>Economy Adjustment:</strong> Coin gain rate reduced from 0.1 to 0.05 per damage dealt</li>
        <li><strong>Bug Fix:</strong> Water areas now completely non-pathable (improved bridge/water pathfinding logic)</li>
      </ul>
      <h3>v0.3.3 - Visual Overhaul & Balance Changes</h3>
      <ul>
        <li><strong>Visual Change:</strong> Units now display as card images instead of circles for better clarity</li>
        <li><strong>Image Size:</strong> Unit images are 3x radius for better visibility and less crowding</li>
        <li><strong>Team Colors:</strong> Colored borders (blue/red) indicate team affiliation</li>
        <li><strong>Balance:</strong> Knight HP buffed 100 ‚Üí 200</li>
        <li><strong>Balance:</strong> Mini-MEGA HP nerfed 300 ‚Üí 250, DMG buffed 80 ‚Üí 100</li>
        <li><strong>Combat Fix:</strong> Melee units now properly hit each other when adjacent (increased attack range tolerance)</li>
        <li><strong>Encyclopedia:</strong> Updated Knight and Mini-MEGA stats</li>
      </ul>
      <h3>v0.3.2 - Skeleton Army & Combat Visual Effects</h3>
      <ul>
        <li><strong>New Card:</strong> Skeleton Army (RARE) - 4 elixir, 8 units with 20 HP each</li>
        <li><strong>Special Ability:</strong> Skeleton Army deals 25 DMG vs MEGA, 5 DMG vs all other units</li>
        <li><strong>Visual Feedback:</strong> Archer attacks now spawn visible arrow projectiles</li>
        <li><strong>Melee Pushback:</strong> Melee units push enemies back 3px on each hit for better combat feedback</li>
        <li><strong>Balance:</strong> Towers cannot be pushed back by melee attacks</li>
        <li><strong>Deck Expansion:</strong> 5 cards available (was 4)</li>
        <li><strong>Encyclopedia:</strong> All unit speeds updated to current values</li>
      </ul>
      <h3>v0.3.1 - Bug Fixes & Balance Updates</h3>
      <ul>
        <li><strong>Bug Fix:</strong> Units no longer walk on water - bridge pathfinding properly restricted to bridge width</li>
        <li><strong>Bug Fix:</strong> Unit card images now display correctly during battle</li>
        <li><strong>Feature:</strong> Players can now place troops at destroyed enemy crossbow tower locations</li>
        <li><strong>Balance:</strong> Updated unit speeds - Knight: 30 px/s, Archers: 35 px/s, Mini-MEGA: 20 px/s, MEGA: 15 px/s</li>
        <li><strong>Optimization:</strong> Card images pre-loaded at game start for better performance</li>
      </ul>
      <h3>v0.3.0 - Individual Pathfinding & Major Gameplay Overhaul</h3>
      <ul>
        <li><strong>Individual A* Pathfinding:</strong> Each unit now computes its own path to the nearest crossbow tower using A* algorithm</li>
        <li><strong>Improved Combat:</strong> Units now engage enemies within 60px aggro range (melee) or weapon range (ranged)</li>
        <li><strong>Bridge Improvements:</strong> Bridges now use solid walkable ground for smooth unit movement - no more gaps!</li>
        <li><strong>Unit Cards:</strong> Unit type cards now display next to units during battle</li>
        <li><strong>Abbreviation Fix:</strong> MEGA units now show 'MG' label, Mini-MEGA shows 'MM'</li>
        <li><strong>Dynamic Targeting:</strong> Units automatically switch to new towers when current target is destroyed</li>
        <li><strong>Visual Aesthetic:</strong> Bridges retain their visual appearance while providing solid ground underneath</li>
      </ul>
      <h3>v0.2.3 - MEGA Unit & UI Enhancements</h3>
      <ul>
        <li><strong>New Card:</strong> MEGA unit added - 5 elixir, 800 HP, 150 DMG / 2.0s (RARE)</li>
        <li><strong>Main Menu:</strong> Redesigned with gradient hero card, animated icon, and enhanced button layout</li>
        <li><strong>Visual Polish:</strong> Added hover effects, smooth transitions, and better typography to main menu</li>
        <li><strong>Deck Expansion:</strong> Player and AI decks now include 4 cards instead of 3</li>
      </ul>
      <h3>v0.2.2 - Persistence & Critical Fixes</h3>
      <ul>
        <li><strong>Persistent Storage:</strong> Coins and card levels now save automatically using localStorage</li>
        <li><strong>Bug Fix:</strong> Archers now properly attack enemies after crossing the bridge</li>
        <li><strong>Bug Fix:</strong> Melee units (especially Knights) now correctly damage King Towers</li>
        <li><strong>Bug Fix:</strong> Bridge pathfinding improved - wider walkable area prevents unit glitching</li>
        <li><strong>Bug Fix:</strong> Deck card images now display with proper aspect ratio</li>
        <li><strong>Balance:</strong> King Tower damage nerfed to 50 / 1.5s (was 50 / 1.0s)</li>
        <li><strong>Balance:</strong> Knight damage buffed to 25 / 1.0s (was 20 / 1.0s)</li>
        <li><strong>Encyclopedia:</strong> Added King Tower and Crossbow Tower stats</li>
      </ul>
      <h3>v0.2.1 - Card Upgrades & Bug Fixes</h3>
      <ul>
        <li><strong>Deck Tab:</strong> New Encyclopedia tab to view and upgrade all your cards</li>
        <li><strong>Card Upgrades:</strong> Spend coins to upgrade cards from Level 0 to 5</li>
        <li><strong>Stat Scaling:</strong> Each level increases Health and Damage by 10% (up to +50% at Level 5)</li>
        <li><strong>Bug Fix:</strong> End game screen now shows correctly when match ends</li>
        <li><strong>Bug Fix:</strong> Coins are now properly awarded and displayed</li>
        <li><strong>Bug Fix:</strong> Archers now properly stop and shoot at range instead of running forward</li>
        <li><strong>Bug Fix:</strong> Units no longer glitch on bridges - smoother pathfinding</li>
      </ul>
      <h3>v0.2.0 - Match System & Currency</h3>
      <ul>
        <li><strong>Match Timer:</strong> 4-minute matches with timer and mode displayed at top</li>
        <li><strong>Win Conditions:</strong> Destroy enemy King for instant win, or win by tower count (2-1, 1-0) when timer expires</li>
        <li><strong>Coin System:</strong> Earn 0.1 coins per damage dealt; coins displayed in Progression tab</li>
        <li><strong>End Game Screen:</strong> View match stats including coins earned, damage dealt, and towers destroyed</li>
        <li><strong>Play Again:</strong> Restart matches without refreshing the page</li>
        <li><strong>Card Progression Tab:</strong> New Encyclopedia tab with upgrade costs for Common and Rare cards</li>
      </ul>
      <h3>v0.1.5</h3>
      <ul>
        <li>Fixed archers to properly use ranged combat: now hold position and shoot instead of charging like melee units.</li>
        <li>Corrected Encyclopedia speed values to match actual game values (px/s units).</li>
      </ul>
      <h3>v0.1.4</h3>
      <ul>
        <li>Lane paths and AI tightened; small on-path separation; ranged standoff.</li>
        <li>Diagnostics always on (toggle with <kbd>D</kbd>); game loop crash-proof.</li>
      </ul>
      <h3>v0.1.3</h3>
      <ul>
        <li>Grid placement overlay and segmented (10) elixir bar.</li>
        <li>Menu/UI fixes and clearer IDs.</li>
      </ul>
      <h3>v0.1.2</h3>
      <ul>
        <li>Initial pathing across bridges and water as no-go.</li>
      </ul>
      <h3>v0.1.1</h3>
      <ul>
        <li>Encyclopedia &amp; update log screens; styling pass.</li>
      </ul>
    </div>
  </section>

  <!-- Single entry module -->
  <script type="module" src="./src/main.js?v=0.3.3"></script>
</body>
</html>
